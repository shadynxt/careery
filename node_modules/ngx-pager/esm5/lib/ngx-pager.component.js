/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { Router, ActivatedRoute } from '@angular/router';
var NgxPagerComponent = /** @class */ (function () {
    /* Function Name : constructor
      * Author :
      * Created Date : 06-03-2019
      * Modified Date : *
      * Purpose : to define the all helpful objects and defin the languages data
      * PARAMS : cService, modalService, translate
      */
    function NgxPagerComponent(route, activeRoute) {
        this.route = route;
        this.activeRoute = activeRoute;
        this.config = null; // set the config
        // set the config
        this.totalrow = null;
        // @Output('page') page = new EventEmitter();
        this.pages = []; // get pages
        // get pages
        this.currentPage = 1; // for current page no
        // for current page no
        this.displayPagesCount = 3; // set no of display page 
        // set no of display page 
        this.totalPage = 1; // get the total page
        // get the total page
        this.simple = false; // to set only next and prev link
        // to set only next and prev link
        this.firstLastView = false; // to set that last first button will display or not
        // to set that last first button will display or not
        this.error = false;
        this.redirectType = '';
        this.redirectParamName = '';
        this.customContent = {
            "prev": "&#10094;",
            "next": "&#x276F;",
            "first": "&#10094;&#10094;",
            "last": "&#x276F;&#x276F;",
        };
    }
    /* Function Name : ngOnInit
      * Author :
      * Created Date : 06-03-2019
      * Modified Date : *
      * Purpose : to get data after html load
      * PARAMS :
      */
    /* Function Name : ngOnInit
        * Author :
        * Created Date : 06-03-2019
        * Modified Date : *
        * Purpose : to get data after html load
        * PARAMS :
        */
    /**
     * @return {?}
     */
    NgxPagerComponent.prototype.ngOnInit = /* Function Name : ngOnInit
        * Author :
        * Created Date : 06-03-2019
        * Modified Date : *
        * Purpose : to get data after html load
        * PARAMS :
        */
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (localStorage.getItem('_nxp') && this.config && !this.config.redirect) {
            /** @type {?} */
            var localUrl = localStorage.getItem('_nxp');
            /** @type {?} */
            var localUrlArr = localUrl.split(":");
            if (localUrlArr[0] == this.route.url) {
                this.currentPage = Number(localUrlArr[1]);
            }
            this.rendering();
        }
        else if (!localStorage.getItem('_nxp') && this.config && !this.config.redirect) {
            localStorage.setItem('_nxp', this.route.url + ':' + this.currentPage);
            this.rendering();
        }
        else if (this.totalrow || this.totalrow == 0) {
            this.error = true;
        }
        else if (this.config && this.config.redirect) {
            localStorage.removeItem("_nxp");
            if (!this.config.redirect.type) {
                console.error("'type' parameter must be set with 'redirect' parameter");
                this.error = true;
                return false;
            }
            if (!this.config.redirect.param) {
                console.error("'param' parameter must be set with 'redirect' parameter");
                this.error = true;
                return false;
            }
            if (!this.error) {
                /** @type {?} */
                var activeRouteObj = null;
                if (this.config.redirect.type === 'q') { // query string
                    activeRouteObj = this.activeRoute.queryParams;
                    this.redirectParamName = this.config.redirect.param;
                }
                else if (this.config.redirect.type === 'p') { // query parameters
                    this.redirectParamName = this.config.redirect.param.name;
                    activeRouteObj = this.activeRoute.params;
                }
                activeRouteObj.subscribe((/**
                 * @param {?} params
                 * @return {?}
                 */
                function (params) {
                    if (params[_this.redirectParamName]) {
                        _this.currentPage = parseInt(params[_this.redirectParamName]);
                    }
                    _this.rendering();
                }));
            }
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    NgxPagerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.totalrow && this.totalrow) {
            this.settings();
        }
    };
    /**
     * @return {?}
     */
    NgxPagerComponent.prototype.settings = /**
     * @return {?}
     */
    function () {
        if (this.config) {
            if (this.config.firstLastView) {
                this.firstLastView = this.config.firstLastView;
            }
            if (this.config.simple) {
                this.simple = this.config.simple;
            }
            if (this.config.displayPageCount) {
                this.displayPagesCount = this.config.displayPageCount;
            }
            if (this.config.customContent) {
                if (this.config.customContent.prev) {
                    this.customContent.prev = this.config.customContent.prev;
                }
                if (this.config.customContent.next) {
                    this.customContent.next = this.config.customContent.next;
                }
                if (this.config.customContent.first) {
                    this.customContent.first = this.config.customContent.first;
                }
                if (this.config.customContent.last) {
                    this.customContent.last = this.config.customContent.last;
                }
            }
            if (this.error === false && this.totalrow && this.config.perPage) {
                this.totalPage = this.totalrow / this.config.perPage;
                if (this.totalPage % 1 != 0) {
                    this.totalPage += 1;
                    this.totalPage = Math.floor(this.totalPage);
                }
            }
            else {
                if (!this.totalrow) {
                    console.error("'totalrow' parameter must be set");
                    this.error = true;
                    // return false;
                }
                if (!this.config.perPage) {
                    console.error("'perPage' parameter must be set");
                    this.error = true;
                    // return false;
                }
            }
            if (this.error === false && this.displayPagesCount > this.totalPage) {
                this.displayPagesCount = this.totalPage;
            }
            if (this.error === false) {
                this.redefinePager();
            }
        }
        else {
            console.error("define 'config' parameters of ngx-pager");
            this.error = true;
            return false;
        }
    };
    /* Function Name : pageClick
      * Author :
      * Created Date : 06-03-2019
      * Modified Date : *
      * Purpose : event for click on page
      * PARAMS : pageNo
      */
    /* Function Name : pageClick
        * Author :
        * Created Date : 06-03-2019
        * Modified Date : *
        * Purpose : event for click on page
        * PARAMS : pageNo
        */
    /**
     * @param {?} event
     * @param {?} pageNo
     * @return {?}
     */
    NgxPagerComponent.prototype.pageClick = /* Function Name : pageClick
        * Author :
        * Created Date : 06-03-2019
        * Modified Date : *
        * Purpose : event for click on page
        * PARAMS : pageNo
        */
    /**
     * @param {?} event
     * @param {?} pageNo
     * @return {?}
     */
    function (event, pageNo) {
        this.currentPage = pageNo;
        // console.log(this.currentPage);
        this.redefinePager();
        if (!this.config.redirect) {
            localStorage.setItem('_nxp', this.route.url + ':' + this.currentPage);
            this.rendering();
        }
        else {
            /** @type {?} */
            var navigateConfig = {
                relativeTo: this.activeRoute
            };
            if (this.config.redirect.type === 'q') {
                navigateConfig['queryParams'] = {};
                navigateConfig['queryParams'][this.redirectParamName] = this.currentPage;
                navigateConfig['queryParamsHandling'] = 'merge';
                this.route.navigate([], navigateConfig);
            }
            else if (this.config.redirect.type === 'p') {
                if (this.config.redirect.param.path) {
                    /** @type {?} */
                    var navigate = [this.config.redirect.param.path];
                    for (var p in this.config.redirect.param.params) {
                        if (p === this.redirectParamName) {
                            navigate.push(this.currentPage);
                        }
                        else {
                            navigate.push(this.config.redirect.param.params[p]);
                        }
                    }
                    this.route.navigate(navigate);
                }
                else {
                    console.error("'url' parameter must be set with 'config.redirect'");
                    this.error = true;
                    return false;
                }
            }
        }
    };
    /* Function Name : redefinePager
      * Author :
      * Created Date : 06-03-2019
      * Modified Date : *
      * Purpose : to create pagination html
      * PARAMS :
      */
    /* Function Name : redefinePager
        * Author :
        * Created Date : 06-03-2019
        * Modified Date : *
        * Purpose : to create pagination html
        * PARAMS :
        */
    /**
     * @return {?}
     */
    NgxPagerComponent.prototype.redefinePager = /* Function Name : redefinePager
        * Author :
        * Created Date : 06-03-2019
        * Modified Date : *
        * Purpose : to create pagination html
        * PARAMS :
        */
    /**
     * @return {?}
     */
    function () {
        this.pages = [];
        this.pages.push(this.currentPage);
        /** @type {?} */
        var leftCount = 0;
        /** @type {?} */
        var rightCount = 0;
        if (this.displayPagesCount % 2 == 0) { // if even display number count
            leftCount = Math.floor(this.displayPagesCount / 3); // one thard in left
            rightCount = Math.floor((this.displayPagesCount * 2) / 3); // two thard in right
            if (this.displayPagesCount % 6 == 0) {
                leftCount -= 1;
            }
        }
        else { // if odd display number count 
            leftCount = Math.floor((this.displayPagesCount - 1) / 2); // half in left
            rightCount = Math.floor((this.displayPagesCount - 1) / 2); // half in right
        }
        /** @type {?} */
        var leftArr = [];
        /** @type {?} */
        var rightArr = [];
        for (var p = 1; p <= leftCount; p++) {
            if ((this.currentPage - p) > 0) {
                leftArr.push(this.currentPage - p);
            }
        }
        if (leftArr.length < leftCount) {
            rightCount += leftCount - leftArr.length;
        }
        for (var p = 1; p <= rightCount; p++) {
            if (this.currentPage + p <= this.totalPage) {
                rightArr.push(this.currentPage + p);
            }
        }
        if (rightArr.length < rightCount) {
            leftCount += rightCount - rightArr.length;
            leftArr = [];
            for (var p = 1; p <= leftCount; p++) {
                if ((this.currentPage - p) > 0) {
                    leftArr.push(this.currentPage - p);
                }
            }
        }
        this.pages = this.pages.concat(leftArr);
        this.pages = this.pages.concat(rightArr);
        this.pages.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) { return a - b; }));
    };
    /**
     * @return {?}
     */
    NgxPagerComponent.prototype.rendering = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.config.render(_this.currentPage);
        }), 5);
    };
    NgxPagerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-pager',
                    template: "<div class=\"ngx-pager-container\" *ngIf=\"!error && totalrow > 0\">\n<ul *ngIf=\"pages\">\n    <li class=\"arrow first\" [class.disabled]=\"currentPage==1\" *ngIf=\"firstLastView && !simple\"><a  href=\"javascript:void(0)\" (click)=\"pageClick($event, 1)\" [innerHTML]=\"customContent.first\"></a></li>\n    \n    <li class=\"arrow prev\" [class.disabled]=\"currentPage==1\"><a  href=\"javascript:void(0)\" (click)=\"pageClick($event, (currentPage-1))\" [innerHTML]=\"customContent.prev\"></a></li>\n    \n    <li *ngFor=\"let p of pages\" [class.active]=\"currentPage==p\" [class.invisible]=\"simple\">\n    <a  href=\"javascript:void(0)\" (click)=\"pageClick($event, p)\">{{ p }}</a>\n    </li>\n    \n    <li class=\"arrow next\" [class.disabled]=\"currentPage==totalPage\"><a  href=\"javascript:void(0)\" (click)=\"pageClick($event, currentPage+1)\" [innerHTML]=\"customContent.next\"></a></li>\n    \n    <li class=\"arrow last\" [class.disabled]=\"currentPage==totalPage\" *ngIf=\"firstLastView && !simple\"><a  href=\"javascript:void(0)\" (click)=\"pageClick($event, totalPage)\" [innerHTML]=\"customContent.last\"></a></li>\n</ul>\n</div>\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    NgxPagerComponent.ctorParameters = function () { return [
        { type: Router },
        { type: ActivatedRoute }
    ]; };
    NgxPagerComponent.propDecorators = {
        config: [{ type: Input }],
        totalrow: [{ type: Input }]
    };
    return NgxPagerComponent;
}());
export { NgxPagerComponent };
if (false) {
    /** @type {?} */
    NgxPagerComponent.prototype.config;
    /** @type {?} */
    NgxPagerComponent.prototype.totalrow;
    /** @type {?} */
    NgxPagerComponent.prototype.pages;
    /** @type {?} */
    NgxPagerComponent.prototype.currentPage;
    /** @type {?} */
    NgxPagerComponent.prototype.displayPagesCount;
    /** @type {?} */
    NgxPagerComponent.prototype.totalPage;
    /** @type {?} */
    NgxPagerComponent.prototype.simple;
    /** @type {?} */
    NgxPagerComponent.prototype.firstLastView;
    /** @type {?} */
    NgxPagerComponent.prototype.error;
    /** @type {?} */
    NgxPagerComponent.prototype.redirectType;
    /** @type {?} */
    NgxPagerComponent.prototype.redirectParamName;
    /** @type {?} */
    NgxPagerComponent.prototype.customContent;
    /**
     * @type {?}
     * @private
     */
    NgxPagerComponent.prototype.route;
    /**
     * @type {?}
     * @private
     */
    NgxPagerComponent.prototype.activeRoute;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXBhZ2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1wYWdlci8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtcGFnZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFXLEtBQUssRUFBMEMsTUFBTSxlQUFlLENBQUM7QUFDbEcsT0FBTyxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6RDtJQTRCRTs7Ozs7O1FBTUM7SUFDRCwyQkFBb0IsS0FBYSxFQUFVLFdBQTJCO1FBQWxELFVBQUssR0FBTCxLQUFLLENBQVE7UUFBVSxnQkFBVyxHQUFYLFdBQVcsQ0FBZ0I7UUE1QjdELFdBQU0sR0FBUSxJQUFJLENBQUMsQ0FBQyxpQkFBaUI7O1FBQ3JDLGFBQVEsR0FBRyxJQUFJLENBQUM7O1FBRXpCLFVBQUssR0FBZ0IsRUFBRSxDQUFDLENBQUMsWUFBWTs7UUFDckMsZ0JBQVcsR0FBWSxDQUFDLENBQUMsQ0FBQyxzQkFBc0I7O1FBQ2hELHNCQUFpQixHQUFXLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjs7UUFDekQsY0FBUyxHQUFXLENBQUMsQ0FBQyxDQUFDLHFCQUFxQjs7UUFDNUMsV0FBTSxHQUFXLEtBQUssQ0FBQyxDQUFDLGlDQUFpQzs7UUFDekQsa0JBQWEsR0FBWSxLQUFLLENBQUMsQ0FBQyxvREFBb0Q7O1FBQ3BGLFVBQUssR0FBYSxLQUFLLENBQUM7UUFDeEIsaUJBQVksR0FBVyxFQUFFLENBQUM7UUFDMUIsc0JBQWlCLEdBQVcsRUFBRSxDQUFDO1FBRS9CLGtCQUFhLEdBQVE7WUFDbkIsTUFBTSxFQUFDLFVBQVU7WUFDakIsTUFBTSxFQUFDLFVBQVU7WUFDakIsT0FBTyxFQUFDLGtCQUFrQjtZQUMxQixNQUFNLEVBQUMsa0JBQWtCO1NBQzFCLENBQUE7SUFVd0UsQ0FBQztJQUMxRTs7Ozs7O1FBTUM7Ozs7Ozs7Ozs7O0lBQ0Qsb0NBQVE7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OztJQUdELHFDQUFTOzs7SUFBVDtRQUFBLGlCQUlDO1FBSEMsVUFBVTs7O1FBQUM7WUFDVCxLQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDdkMsQ0FBQyxHQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQzs7Z0JBeFFGLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsV0FBVztvQkFDckIseW9DQUF3Qzs7aUJBRXpDOzs7O2dCQUxRLE1BQU07Z0JBQUUsY0FBYzs7O3lCQVE1QixLQUFLOzJCQUNMLEtBQUs7O0lBaVFSLHdCQUFDO0NBQUEsQUF6UUQsSUF5UUM7U0FwUVksaUJBQWlCOzs7SUFFNUIsbUNBQTRCOztJQUM1QixxQ0FBeUI7O0lBRXpCLGtDQUF3Qjs7SUFDeEIsd0NBQXlCOztJQUN6Qiw4Q0FBOEI7O0lBQzlCLHNDQUFzQjs7SUFDdEIsbUNBQXVCOztJQUN2QiwwQ0FBK0I7O0lBQy9CLGtDQUF3Qjs7SUFDeEIseUNBQTBCOztJQUMxQiw4Q0FBK0I7O0lBRS9CLDBDQUtDOzs7OztJQVVXLGtDQUFxQjs7Ozs7SUFBRSx3Q0FBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsICBPdXRwdXQsIElucHV0LCBFdmVudEVtaXR0ZXIgLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXN9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyLCBBY3RpdmF0ZWRSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtcGFnZXInLFxuICB0ZW1wbGF0ZVVybDonLi9uZ3gtcGFnZXIuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9uZ3gtcGFnZXIuY29tcG9uZW50LnNjc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hQYWdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG5cbiAgQElucHV0KCkgY29uZmlnOiBhbnkgPSBudWxsOyAvLyBzZXQgdGhlIGNvbmZpZ1xuICBASW5wdXQoKSB0b3RhbHJvdyA9IG51bGw7XG4gIC8vIEBPdXRwdXQoJ3BhZ2UnKSBwYWdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBwYWdlcyA6IEFycmF5PGFueT4gPSBbXTsgLy8gZ2V0IHBhZ2VzXG4gIGN1cnJlbnRQYWdlIDogbnVtYmVyID0gMTsgLy8gZm9yIGN1cnJlbnQgcGFnZSBub1xuICBkaXNwbGF5UGFnZXNDb3VudDogbnVtYmVyID0gMzsgLy8gc2V0IG5vIG9mIGRpc3BsYXkgcGFnZSBcbiAgdG90YWxQYWdlOiBudW1iZXIgPSAxOyAvLyBnZXQgdGhlIHRvdGFsIHBhZ2VcbiAgc2ltcGxlOmJvb2xlYW4gPSBmYWxzZTsgLy8gdG8gc2V0IG9ubHkgbmV4dCBhbmQgcHJldiBsaW5rXG4gIGZpcnN0TGFzdFZpZXc6IGJvb2xlYW4gPSBmYWxzZTsgLy8gdG8gc2V0IHRoYXQgbGFzdCBmaXJzdCBidXR0b24gd2lsbCBkaXNwbGF5IG9yIG5vdFxuICBlcnJvciA6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcmVkaXJlY3RUeXBlOiBzdHJpbmcgPSAnJztcbiAgcmVkaXJlY3RQYXJhbU5hbWU6IHN0cmluZyA9ICcnO1xuXG4gIGN1c3RvbUNvbnRlbnQ6IGFueSA9IHtcbiAgICBcInByZXZcIjpcIiYjMTAwOTQ7XCIsXG4gICAgXCJuZXh0XCI6XCImI3gyNzZGO1wiLFxuICAgIFwiZmlyc3RcIjpcIiYjMTAwOTQ7JiMxMDA5NDtcIixcbiAgICBcImxhc3RcIjpcIiYjeDI3NkY7JiN4Mjc2RjtcIixcbiAgfVxuXG5cbiAgLyogRnVuY3Rpb24gTmFtZSA6IGNvbnN0cnVjdG9yXG5cdCogQXV0aG9yIDogXG5cdCogQ3JlYXRlZCBEYXRlIDogMDYtMDMtMjAxOSBcblx0KiBNb2RpZmllZCBEYXRlIDogKlxuXHQqIFB1cnBvc2UgOiB0byBkZWZpbmUgdGhlIGFsbCBoZWxwZnVsIG9iamVjdHMgYW5kIGRlZmluIHRoZSBsYW5ndWFnZXMgZGF0YVxuXHQqIFBBUkFNUyA6IGNTZXJ2aWNlLCBtb2RhbFNlcnZpY2UsIHRyYW5zbGF0ZVxuXHQqL1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvdXRlOiBSb3V0ZXIsIHByaXZhdGUgYWN0aXZlUm91dGU6IEFjdGl2YXRlZFJvdXRlKSB7fVxuICAvKiBGdW5jdGlvbiBOYW1lIDogbmdPbkluaXRcblx0KiBBdXRob3IgOiBcblx0KiBDcmVhdGVkIERhdGUgOiAwNi0wMy0yMDE5IFxuXHQqIE1vZGlmaWVkIERhdGUgOiAqXG5cdCogUHVycG9zZSA6IHRvIGdldCBkYXRhIGFmdGVyIGh0bWwgbG9hZFxuXHQqIFBBUkFNUyA6IFxuXHQqL1xuICBuZ09uSW5pdCgpIHtcbiAgICBcbiAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ19ueHAnKSAmJiB0aGlzLmNvbmZpZyAmJiAhdGhpcy5jb25maWcucmVkaXJlY3QpIHtcbiAgICAgICAgICBcbiAgICAgIGxldCBsb2NhbFVybCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdfbnhwJyk7XG4gICAgICBsZXQgbG9jYWxVcmxBcnIgPSBsb2NhbFVybC5zcGxpdChcIjpcIik7XG4gICAgICBpZiAobG9jYWxVcmxBcnJbMF0gPT0gdGhpcy5yb3V0ZS51cmwpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IE51bWJlcihsb2NhbFVybEFyclsxXSk7XG4gICAgICB9XG4gICAgICB0aGlzLnJlbmRlcmluZygpO1xuICAgIH0gXG4gICAgZWxzZSBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKCdfbnhwJykgJiYgdGhpcy5jb25maWcgJiYgIXRoaXMuY29uZmlnLnJlZGlyZWN0KSB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnX254cCcsIHRoaXMucm91dGUudXJsKyc6Jyt0aGlzLmN1cnJlbnRQYWdlKTtcbiAgICAgIHRoaXMucmVuZGVyaW5nKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRoaXMudG90YWxyb3cgfHwgdGhpcy50b3RhbHJvdyA9PSAwKSB7XG4gICAgICAgIHRoaXMuZXJyb3IgPSB0cnVlO1xuICAgIH1cbiAgICBlbHNlIGlmKHRoaXMuY29uZmlnICYmIHRoaXMuY29uZmlnLnJlZGlyZWN0KXtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiX254cFwiKTtcbiAgICAgIGlmICghdGhpcy5jb25maWcucmVkaXJlY3QudHlwZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiJ3R5cGUnIHBhcmFtZXRlciBtdXN0IGJlIHNldCB3aXRoICdyZWRpcmVjdCcgcGFyYW1ldGVyXCIpO1xuICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmNvbmZpZy5yZWRpcmVjdC5wYXJhbSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiJ3BhcmFtJyBwYXJhbWV0ZXIgbXVzdCBiZSBzZXQgd2l0aCAncmVkaXJlY3QnIHBhcmFtZXRlclwiKTtcbiAgICAgICAgdGhpcy5lcnJvciA9IHRydWU7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5lcnJvcikge1xuICAgICAgICAgIGxldCBhY3RpdmVSb3V0ZU9iaiA9ICBudWxsO1xuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5yZWRpcmVjdC50eXBlID09PSAncScpIHsgLy8gcXVlcnkgc3RyaW5nXG4gICAgICAgICAgICBhY3RpdmVSb3V0ZU9iaiA9IHRoaXMuYWN0aXZlUm91dGUucXVlcnlQYXJhbXM7XG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0UGFyYW1OYW1lID0gdGhpcy5jb25maWcucmVkaXJlY3QucGFyYW07XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZy5yZWRpcmVjdC50eXBlID09PSAncCcpIHsgLy8gcXVlcnkgcGFyYW1ldGVyc1xuICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFBhcmFtTmFtZSA9IHRoaXMuY29uZmlnLnJlZGlyZWN0LnBhcmFtLm5hbWU7XG4gICAgICAgICAgICBhY3RpdmVSb3V0ZU9iaiA9IHRoaXMuYWN0aXZlUm91dGUucGFyYW1zO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGFjdGl2ZVJvdXRlT2JqLnN1YnNjcmliZShwYXJhbXMgPT4ge1xuICAgICAgICAgICAgaWYgKHBhcmFtc1t0aGlzLnJlZGlyZWN0UGFyYW1OYW1lXSkge1xuICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gcGFyc2VJbnQocGFyYW1zW3RoaXMucmVkaXJlY3RQYXJhbU5hbWVdKTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmluZygpO1xuICAgICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6U2ltcGxlQ2hhbmdlcykge1xuXG4gICAgaWYgKGNoYW5nZXMudG90YWxyb3cgJiYgdGhpcy50b3RhbHJvdykgIHtcbiAgICAgIFxuICAgICAgdGhpcy5zZXR0aW5ncygpO1xuICAgIH1cbiAgfVxuICBzZXR0aW5ncygpIHtcbiAgICBpZiAodGhpcy5jb25maWcpIHtcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuY29uZmlnLmZpcnN0TGFzdFZpZXcpIHtcbiAgICAgICAgdGhpcy5maXJzdExhc3RWaWV3ID0gdGhpcy5jb25maWcuZmlyc3RMYXN0VmlldztcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5zaW1wbGUpIHtcbiAgICAgICAgdGhpcy5zaW1wbGUgPSB0aGlzLmNvbmZpZy5zaW1wbGU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5jb25maWcuZGlzcGxheVBhZ2VDb3VudCkge1xuICAgICAgICB0aGlzLmRpc3BsYXlQYWdlc0NvdW50ID0gdGhpcy5jb25maWcuZGlzcGxheVBhZ2VDb3VudDtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuY29uZmlnLmN1c3RvbUNvbnRlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmN1c3RvbUNvbnRlbnQucHJldikge1xuICAgICAgICAgIHRoaXMuY3VzdG9tQ29udGVudC5wcmV2ID0gdGhpcy5jb25maWcuY3VzdG9tQ29udGVudC5wcmV2O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5jdXN0b21Db250ZW50Lm5leHQpIHtcbiAgICAgICAgICB0aGlzLmN1c3RvbUNvbnRlbnQubmV4dCA9IHRoaXMuY29uZmlnLmN1c3RvbUNvbnRlbnQubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jb25maWcuY3VzdG9tQ29udGVudC5maXJzdCkge1xuICAgICAgICAgIHRoaXMuY3VzdG9tQ29udGVudC5maXJzdCA9IHRoaXMuY29uZmlnLmN1c3RvbUNvbnRlbnQuZmlyc3Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmN1c3RvbUNvbnRlbnQubGFzdCkge1xuICAgICAgICAgIHRoaXMuY3VzdG9tQ29udGVudC5sYXN0ID0gdGhpcy5jb25maWcuY3VzdG9tQ29udGVudC5sYXN0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0aGlzLmVycm9yID09PSBmYWxzZSAmJiB0aGlzLnRvdGFscm93ICYmIHRoaXMuY29uZmlnLnBlclBhZ2UpIHtcbiAgICAgICAgdGhpcy50b3RhbFBhZ2UgPSB0aGlzLnRvdGFscm93L3RoaXMuY29uZmlnLnBlclBhZ2U7XG4gICAgICAgIGlmICh0aGlzLnRvdGFsUGFnZSUxICE9IDApIHtcbiAgICAgICAgICB0aGlzLnRvdGFsUGFnZSArPTE7XG4gICAgICAgICAgdGhpcy50b3RhbFBhZ2UgPSBNYXRoLmZsb29yKHRoaXMudG90YWxQYWdlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCF0aGlzLnRvdGFscm93KSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIid0b3RhbHJvdycgcGFyYW1ldGVyIG11c3QgYmUgc2V0XCIpO1xuICAgICAgICAgIHRoaXMuZXJyb3IgPSB0cnVlO1xuICAgICAgICAgIC8vIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuY29uZmlnLnBlclBhZ2UpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiJ3BlclBhZ2UnIHBhcmFtZXRlciBtdXN0IGJlIHNldFwiKTtcbiAgICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAvLyByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHRoaXMuZXJyb3IgPT09IGZhbHNlICYmIHRoaXMuZGlzcGxheVBhZ2VzQ291bnQgPiB0aGlzLnRvdGFsUGFnZSkge1xuICAgICAgICB0aGlzLmRpc3BsYXlQYWdlc0NvdW50ID0gdGhpcy50b3RhbFBhZ2U7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5lcnJvciA9PT0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5yZWRlZmluZVBhZ2VyKCk7XG4gICAgICB9XG4gICAgIFxuICAgICAgXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJkZWZpbmUgJ2NvbmZpZycgcGFyYW1ldGVycyBvZiBuZ3gtcGFnZXJcIik7XG4gICAgICB0aGlzLmVycm9yID0gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgLyogRnVuY3Rpb24gTmFtZSA6IHBhZ2VDbGlja1xuXHQqIEF1dGhvciA6IFxuXHQqIENyZWF0ZWQgRGF0ZSA6IDA2LTAzLTIwMTkgXG5cdCogTW9kaWZpZWQgRGF0ZSA6ICpcblx0KiBQdXJwb3NlIDogZXZlbnQgZm9yIGNsaWNrIG9uIHBhZ2Vcblx0KiBQQVJBTVMgOiBwYWdlTm9cblx0Ki9cbiAgcGFnZUNsaWNrKGV2ZW50LCBwYWdlTm8pIHtcbiAgICB0aGlzLmN1cnJlbnRQYWdlID0gcGFnZU5vO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY3VycmVudFBhZ2UpO1xuICAgIHRoaXMucmVkZWZpbmVQYWdlcigpO1xuICAgIGlmICghdGhpcy5jb25maWcucmVkaXJlY3QpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdfbnhwJywgdGhpcy5yb3V0ZS51cmwrJzonK3RoaXMuY3VycmVudFBhZ2UpO1xuICAgICAgdGhpcy5yZW5kZXJpbmcoKTtcbiAgICAgIFxuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgbmF2aWdhdGVDb25maWcgPSB7XG4gICAgICAgIHJlbGF0aXZlVG86IHRoaXMuYWN0aXZlUm91dGVcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5yZWRpcmVjdC50eXBlID09PSAncScpIHtcbiAgICAgICAgbmF2aWdhdGVDb25maWdbJ3F1ZXJ5UGFyYW1zJ10gPSB7fTtcbiAgICAgICAgbmF2aWdhdGVDb25maWdbJ3F1ZXJ5UGFyYW1zJ11bdGhpcy5yZWRpcmVjdFBhcmFtTmFtZV0gPSB0aGlzLmN1cnJlbnRQYWdlO1xuICAgICAgICBuYXZpZ2F0ZUNvbmZpZ1sncXVlcnlQYXJhbXNIYW5kbGluZyddID0gJ21lcmdlJztcbiAgICAgICAgdGhpcy5yb3V0ZS5uYXZpZ2F0ZShbXSwgbmF2aWdhdGVDb25maWcpOyAgXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY29uZmlnLnJlZGlyZWN0LnR5cGUgPT09ICdwJykge1xuICAgICAgICBpZiAodGhpcy5jb25maWcucmVkaXJlY3QucGFyYW0ucGF0aCkge1xuICAgICAgICAgIGxldCBuYXZpZ2F0ZSA9IFt0aGlzLmNvbmZpZy5yZWRpcmVjdC5wYXJhbS5wYXRoXTtcbiAgICAgICAgICBmb3IgKGxldCBwIGluIHRoaXMuY29uZmlnLnJlZGlyZWN0LnBhcmFtLnBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHA9PT10aGlzLnJlZGlyZWN0UGFyYW1OYW1lKSB7XG4gICAgICAgICAgICAgIG5hdmlnYXRlLnB1c2godGhpcy5jdXJyZW50UGFnZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuYXZpZ2F0ZS5wdXNoKHRoaXMuY29uZmlnLnJlZGlyZWN0LnBhcmFtLnBhcmFtc1twXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMucm91dGUubmF2aWdhdGUobmF2aWdhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCIndXJsJyBwYXJhbWV0ZXIgbXVzdCBiZSBzZXQgd2l0aCAnY29uZmlnLnJlZGlyZWN0J1wiKTtcbiAgICAgICAgICB0aGlzLmVycm9yID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICB9XG4gICAgICBcbiAgICB9XG4gIH1cbiAgLyogRnVuY3Rpb24gTmFtZSA6IHJlZGVmaW5lUGFnZXJcblx0KiBBdXRob3IgOiBcblx0KiBDcmVhdGVkIERhdGUgOiAwNi0wMy0yMDE5IFxuXHQqIE1vZGlmaWVkIERhdGUgOiAqXG5cdCogUHVycG9zZSA6IHRvIGNyZWF0ZSBwYWdpbmF0aW9uIGh0bWxcblx0KiBQQVJBTVMgOiBcblx0Ki9cbiAgcmVkZWZpbmVQYWdlcigpIHtcbiAgICAgIHRoaXMucGFnZXMgPSBbXTtcbiAgICAgIHRoaXMucGFnZXMucHVzaCh0aGlzLmN1cnJlbnRQYWdlKTtcbiAgICAgIGxldCBsZWZ0Q291bnQgPSAwO1xuICAgICAgbGV0IHJpZ2h0Q291bnQgPSAwO1xuICAgICAgaWYgKHRoaXMuZGlzcGxheVBhZ2VzQ291bnQlMiA9PSAwKSB7IC8vIGlmIGV2ZW4gZGlzcGxheSBudW1iZXIgY291bnRcbiAgICAgICAgbGVmdENvdW50ID0gTWF0aC5mbG9vcih0aGlzLmRpc3BsYXlQYWdlc0NvdW50LzMpOyAvLyBvbmUgdGhhcmQgaW4gbGVmdFxuICAgICAgICByaWdodENvdW50ID0gTWF0aC5mbG9vcigodGhpcy5kaXNwbGF5UGFnZXNDb3VudCoyKS8zKTsgLy8gdHdvIHRoYXJkIGluIHJpZ2h0XG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlQYWdlc0NvdW50JTYgPT0gMCkge1xuICAgICAgICAgIGxlZnRDb3VudCAtPTE7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7IC8vIGlmIG9kZCBkaXNwbGF5IG51bWJlciBjb3VudCBcbiAgICAgICAgbGVmdENvdW50ID0gTWF0aC5mbG9vcigodGhpcy5kaXNwbGF5UGFnZXNDb3VudC0xKS8yKTsgLy8gaGFsZiBpbiBsZWZ0XG4gICAgICAgIHJpZ2h0Q291bnQgPSBNYXRoLmZsb29yKCh0aGlzLmRpc3BsYXlQYWdlc0NvdW50LTEpLzIpOyAvLyBoYWxmIGluIHJpZ2h0XG4gICAgICAgIFxuICAgICAgfVxuICAgICAgbGV0IGxlZnRBcnI9W10sIHJpZ2h0QXJyPVtdO1xuICAgICAgZm9yIChsZXQgcD0xOyBwPD1sZWZ0Q291bnQ7IHArKykge1xuICAgICAgICBpZiAoKHRoaXMuY3VycmVudFBhZ2UtcCkgPiAwICkge1xuICAgICAgICAgIGxlZnRBcnIucHVzaCh0aGlzLmN1cnJlbnRQYWdlLXApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAobGVmdEFyci5sZW5ndGggPCBsZWZ0Q291bnQpIHtcbiAgICAgICAgcmlnaHRDb3VudCArPSBsZWZ0Q291bnQtbGVmdEFyci5sZW5ndGg7IFxuICAgICAgfVxuICAgICAgZm9yIChsZXQgcD0xOyBwPD1yaWdodENvdW50OyBwKyspIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UrcCA8PSB0aGlzLnRvdGFsUGFnZSkge1xuICAgICAgICAgIHJpZ2h0QXJyLnB1c2godGhpcy5jdXJyZW50UGFnZStwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHJpZ2h0QXJyLmxlbmd0aCA8IHJpZ2h0Q291bnQpIHtcbiAgICAgICAgbGVmdENvdW50ICs9IHJpZ2h0Q291bnQgLSByaWdodEFyci5sZW5ndGggIDtcbiAgICAgICAgbGVmdEFyciA9IFtdO1xuICAgICAgICBmb3IgKGxldCBwPTE7IHA8PWxlZnRDb3VudDsgcCsrKSB7XG4gICAgICAgICAgaWYgKCh0aGlzLmN1cnJlbnRQYWdlLXApID4gMCApIHtcbiAgICAgICAgICAgIGxlZnRBcnIucHVzaCh0aGlzLmN1cnJlbnRQYWdlLXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5wYWdlcyA9IHRoaXMucGFnZXMuY29uY2F0KGxlZnRBcnIpO1xuICAgICAgdGhpcy5wYWdlcyA9IHRoaXMucGFnZXMuY29uY2F0KHJpZ2h0QXJyKTtcbiAgICAgIFxuICAgICAgdGhpcy5wYWdlcy5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG5cbiAgfVxuXG5cbiAgcmVuZGVyaW5nKCkge1xuICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgIHRoaXMuY29uZmlnLnJlbmRlcih0aGlzLmN1cnJlbnRQYWdlKTtcbiAgICB9LDUpXG4gIH1cbn1cbiJdfQ==